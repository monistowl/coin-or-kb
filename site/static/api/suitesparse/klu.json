{
  "name": "klu",
  "library": "SuiteSparse",
  "layer": "layer-0",
  "header": "KLU/Include/klu.h",
  "brief": "Sparse LU factorization optimized for circuit simulation matrices\n\nKLU computes a sparse LU factorization of a square matrix A:\n  P*A*Q = L*U\nwhere P and Q are permutation matrices, L is unit lower triangular,\nand U is upper triangular.\n\nKLU is specifically designed for matrices arising from circuit simulation,\nwhich tend to be sparse and nearly block-triangular. The factorization\nproceeds in three phases:\n1. klu_analyze: BTF pre-ordering + fill-reducing ordering (AMD/COLAMD)\n2. klu_factor: Numerical LU factorization (left-looking, column-by-column)\n3. klu_solve: Forward/back substitution to solve Ax = b",
  "algorithms": [
    {
      "name": "Left-looking LU with BTF preprocessing and partial pivoting:\n  1. BTF pre-ordering (Tarjan's algorithm):\n     - Find strongly connected components of digraph(A)\n     - Permute to block upper triangular form (BTF)\n     - Each diagonal block factored independently\n  2. Fill-reducing ordering within blocks:\n     - AMD for symmetric pattern blocks, COLAMD for unsymmetric\n  3. Left-looking column-by-column LU:\n     - For column k: solve L_{1:k-1, 1:k-1} \u00b7 x = A_{1:k-1, k}\n     - Apply partial pivoting within column\n     - Extract L_{k+1:n, k} and U_{1:k, k}",
      "math": "Block Triangular Form: P\u00b7A\u00b7Q has structure\n  | B_11  B_12  ...  B_1m |\n  |   0   B_22  ...  B_2m |\n  |   \u22ee     \u22f1    \u22f1    \u22ee  |\n  |   0    0   ...  B_mm |\n  Each B_ii is factored as P_i\u00b7B_ii = L_i\u00b7U_i independently.\n  Off-diagonal blocks solved via triangular solves.",
      "complexity": "Time: O(\u03a3 nnz(L_i)\u00b7nnz(U_i)/n_i + off-diagonal work)\n  For circuit matrices: typically O(n) to O(n log n) due to BTF structure\n  Much faster than UMFPACK for matrices with many small diagonal blocks.\n  Space: O(nnz(L+U)) for factors, O(maxblock) workspace per block.",
      "ref": [
        "Davis, Palamadai (2010). \"KLU: A Direct Sparse Solver for Circuit\n     Simulation Problems\". ACM Trans. Math. Software.",
        "Duff, Reid (1978). \"An Implementation of Tarjan's Algorithm for the\n     Block Triangularization of a Matrix\". ACM Trans. Math. Software 4(2)."
      ]
    }
  ],
  "methods": [],
  "see": [
    "btf.h for BTF decomposition",
    "amd.h, colamd.h for fill-reducing orderings",
    "umfpack.h for general-purpose multifrontal LU",
    "klu_analyze() to create this object",
    "klu_factor() to use this for numerical factorization",
    "klu_factor() to create this object",
    "klu_solve() to use for solving linear systems",
    "klu_refactor() to update with new numerical values",
    "klu_defaults() to initialize",
    "klu_defaults()",
    "klu_factor() to perform numerical factorization",
    "klu_free_symbolic() to free the returned object",
    "klu_analyze()",
    "klu_analyze() for automatic ordering",
    "klu_analyze_given()",
    "klu_solve() to solve linear systems using the factorization",
    "klu_refactor() to update factorization with new values",
    "klu_factor()",
    "klu_factor()",
    "klu_factor()",
    "klu_tsolve() for transpose solve A'x = b",
    "klu_solve()",
    "klu_solve()",
    "klu_solve()",
    "klu_solve() for standard solve Ax = b",
    "klu_free_symbolic()",
    "klu_condest() for a more accurate (but slower) condition estimate"
  ]
}